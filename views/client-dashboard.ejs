<!DOCTYPE html>
<html>

<head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link rel="stylesheet" as="style" onload="this.rel='stylesheet'"
        href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Plus+Jakarta+Sans:wght@400;500;700;800" />
    <title>Pawsitive Match | Client Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/images/paw.ico" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
</head>

<body>
    <div class="relative flex min-h-screen flex-col bg-[#f4f2f1] text-[#171412] antialiased"
        style='font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;'>

        <div class="layout-container flex h-full grow flex-col">
            <!-- Header -->
            <header
                class="sticky top-0 z-50 flex items-center justify-between border-b border-solid border-b-[#f4f2f1] px-10 py-3 bg-white shadow-md">
                <div class="flex items-center gap-4 text-[#171412]">
                    <img src="/images/logo.png" alt="Pawsitive Match Logo" style="height:40px;"
                        class="inline-block align-middle" />
                    <h2 class="text-[#171412] text-lg font-bold leading-tight tracking-[-0.015em]">Pawsitive Match</h2>
                </div>

                <div class="flex flex-1 justify-end gap-8">
                    <div class="flex items-center gap-9">
                        <a class="text-[#171412] text-sm font-medium leading-normal" href="#adoption-requests">My
                            Requests</a>
                        <a class="text-[#171412] text-sm font-medium leading-normal" href="#history">My Adoptions</a>
                        <a class="text-[#171412] text-sm font-medium leading-normal" href="#browse">Browse</a>
                    </div>
                    <form action="/logout" method="POST">
                        <button type="submit"
                            class="flex cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 bg-[#f4f2f1] text-[#171412] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5">
                            Logout
                        </button>
                    </form>
                    <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 ml-4"
                        style='background-image: url("/images/default-avatar.png");'></div>
                </div>
            </header>

            <div class="px-40 flex flex-1 justify-center py-5">
                <div class="layout-content-container flex flex-col max-w-[90vw] flex-1">

                    <!-- Profile -->
                    <div class="flex flex-col gap-4 p-4">
                        <div class="inline-block bg-white px-6 py-2 rounded-xl shadow-sm mb-2">
                            <h1
                                class="text-3xl font-extrabold text-[#47aed1] inline-block align-middle mr-2 italic font-serif">
                                Hello,</h1>
                            <span class="text-2xl font-bold text-[#171412] align-middle italic font-serif">
                                <%= user.full_name %>
                            </span>
                            <span class="text-2xl align-middle">üêæ</span>
                        </div>
                        <p class="text-[#837567] text-base font-normal leading-normal">Email: <%= user.email %>
                        </p>
                        <p class="text-[#837567] text-base font-normal leading-normal">Phone: <%= user.phone_number %>
                        </p>
                        <p class="text-[#837567] text-base font-normal leading-normal">Address: <%= user.address %>
                        </p>
                    </div>

                    <!-- Adoption Requests -->
                    <h2 id="adoption-requests"
                        class="text-[#171412] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">
                        My Adoption Requests</h2>
                    <div class="px-4 py-3">
                        <div class="flex overflow-hidden rounded-xl border border-[#e4e0dd] bg-white">
                            <table class="flex-1 w-full">
                                <thead>
                                    <tr class="bg-white">
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Pet Name</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Breed</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Species</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Shelter Name</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Shelter Address</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Shelter Contact</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Request Date</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Visit Date</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Your Message</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Shelter Response</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Status</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% adoptions.forEach(function(req) { %>
                                        <tr class="border-t border-t-[#e4e0dd]">
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#171412] text-sm font-normal leading-normal">
                                                <%= req.pet_name %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= req.breed %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= req.species %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= req.shelter_name ? req.shelter_name : '‚Äî' %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= req.shelter_address ? req.shelter_address : '‚Äî' %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= req.shelter_contact ? req.shelter_contact : '‚Äî' %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= req.request_date ? new
                                                    Date(req.request_date).toISOString().slice(0,10) : '‚Äî' %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= req.visit_date ? new Date(req.visit_date).toISOString().slice(0,10)
                                                    : '‚Äî' %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= req.client_reason ? req.client_reason : '‚Äî' %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= req.shelter_response ? req.shelter_response : '‚Äî' %>
                                            </td>
                                            <td class="h-[72px] px-4 py-2 text-sm font-normal leading-normal">
                                                <span
                                                    class="flex min-w-[84px] max-w-[480px] items-center justify-center overflow-hidden rounded-full h-8 px-4 bg-[#f4f2f1] text-[#171412] text-sm font-medium leading-normal w-full">
                                                    <%= req.status %>
                                                </span>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <% if (req.status==='Pending' ) { %>
                                                    <form method="POST" action="/adoption/cancel"
                                                        style="display:inline;">
                                                        <input type="hidden" name="adoption_id"
                                                            value="<%= req.adoption_id %>">
                                                        <button type="submit"
                                                            class="ml-2 px-3 py-1 rounded bg-red-100 text-red-700 text-xs font-semibold hover:bg-red-200">
                                                            Cancel
                                                        </button>
                                                    </form>
                                                    <% } %>
                                            </td>
                                        </tr>
                                        <% }); %>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Adoption History -->
                    <h2 id="history"
                        class="text-[#171412] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">
                        My Adoptions</h2>
                    <div class="px-4 py-3">
                        <div class="flex overflow-hidden rounded-xl border border-[#e4e0dd] bg-white">
                            <table class="flex-1 w-full">
                                <thead>
                                    <tr class="bg-white">
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Pet Name</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Breed</th>
                                        <th
                                            class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                            Date Adopted</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% adoptions.filter(a=> a.status === 'Approved' || a.status ===
                                        'Completed').forEach(function(hist) { %>
                                        <tr class="border-t border-t-[#e4e0dd]">
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#171412] text-sm font-normal leading-normal">
                                                <%= hist.pet_name %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= hist.breed %>
                                            </td>
                                            <td
                                                class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                                <%= hist.approval_date ? new
                                                    Date(hist.approval_date).toISOString().slice(0,10) : '' %>
                                            </td>
                                        </tr>
                                        <% }); %>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Browse Pets -->
                    <h2 id="browse"
                        class="text-[#171412] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">
                        Browse Pets</h2>
                    <div class="px-4 py-3">
                        <form method="GET" action="/client/dashboard">
                            <label class="flex flex-col min-w-40 h-12 w-full">
                                <div class="flex w-full flex-1 items-stretch rounded-xl h-full">
                                    <div
                                        class="text-[#837567] flex border-none bg-white items-center justify-center pl-4 rounded-l-xl border-r-0">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px"
                                            fill="currentColor" viewBox="0 0 256 256">
                                            <path
                                                d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z">
                                            </path>
                                        </svg>
                                    </div>
                                    <input type="text" name="search" placeholder="Search for pets"
                                        class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#171412] focus:outline-0 focus:ring-0 border-none bg-white focus:border-none h-full placeholder:text-[#837567] px-4 rounded-l-none border-l-0 pl-2 text-base font-normal leading-normal"
                                        value="<%= typeof search !== 'undefined' ? search : '' %>" />
                                </div>
                            </label>
                        </form>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6 p-4">
                        <% pets.forEach(function(pet) { %>
                            <div class="flex flex-col gap-3 pb-3 bg-white rounded-xl shadow p-4">
                                <img src="<%= pet.pet_image %>" alt="Pet Image"
                                    class="h-40 w-40 object-cover rounded-xl mx-auto" />
                                <div>
                                    <p class="text-[#171412] text-base font-medium leading-normal">
                                        <%= pet.name %>
                                    </p>
                                    <p class="text-[#837567] text-sm font-normal leading-normal">
                                        <%= pet.breed %>, <%= pet.age %> years
                                    </p>
                                    <p class="text-[#837567] text-xs font-normal leading-normal">
                                        Shelter: <%= pet.shelter_name %> (<%= pet.shelter_address %>)
                                    </p>
                                </div>
                                <form method="POST" action="/adoption/request">
                                    <input type="hidden" name="pet_id" value="<%= pet.pet_id %>">
                                    <textarea name="client_reason"
                                        placeholder="Write a message to the shelter (optional)"
                                        class="block w-full rounded-lg border border-[#e4e0dd] p-2 my-2 text-sm resize-none"
                                        rows="2"></textarea>
                                    <button type="submit"
                                        class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#d18c47] text-[#171412] text-sm font-bold leading-normal tracking-[0.015em]">
                                        <span class="truncate">Request Adoption</span>
                                    </button>
                                </form>
                            </div>
                            <% }); %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>