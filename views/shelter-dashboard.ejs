<!DOCTYPE html>
<html>

<head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link rel="stylesheet" as="style" onload="this.rel='stylesheet'"
        href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Plus+Jakarta+Sans:wght@400;500;700;800" />
    <title>Pawsitive Match | Shelter Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/images/paw.ico" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
</head>

<body>
    <div class="relative flex min-h-screen flex-col bg-[#f4f2f1] text-[#171412] antialiased"
        style='font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;'>

        <!-- Header -->
        <header
            class="sticky top-0 z-50 flex items-center justify-between border-b border-solid border-b-[#f4f2f1] px-10 py-3 bg-white shadow-md">
            <div class="flex items-center gap-4 text-[#171412]">
                <img src="/images/logo.png" alt="Pawsitive Match Logo" style="height:40px;"
                    class="inline-block align-middle" />
                <h2 class="text-[#171412] text-lg font-bold leading-tight tracking-[-0.015em]">Pawsitive Match</h2>
            </div>
            <div class="flex flex-1 justify-end gap-8">
                <div class="flex items-center gap-9">
                    <a class="text-[#171412] text-sm font-medium leading-normal" href="#adoption-requests">Requests</a>
                    <a class="text-[#171412] text-sm font-medium leading-normal" href="#my-pets">My Pets</a>
                    <a class="text-[#171412] text-sm font-medium leading-normal" href="#add-pet">Add Pet</a>
                </div>
                <form action="/logout" method="POST">
                    <button type="submit"
                        class="flex cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 bg-[#f4f2f1] text-[#171412] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5 border border-black">
                        Logout
                    </button>
                </form>
                <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 ml-4"
                    style='background-image: url("/images/default-avatar.png");'></div>
            </div>
        </header>

        <div class="px-40 flex flex-1 justify-center py-5">
            <div class="layout-content-container flex flex-col max-w-[90vw] flex-1">

                <!-- Adoption Requests Table -->
                <h2 id="adoption-requests"
                    class="text-[#171412] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">
                    Adoption Requests</h2>
                <div class="px-4 py-3">
                    <div class="flex overflow-hidden rounded-xl border border-[#e4e0dd] bg-white">
                        <table class="flex-1 w-full">
                            <thead>
                                <tr class="bg-white">
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Pet</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Client</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Contact</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Request Date</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Client Message</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Shelter Response</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Visit Date</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Status</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% adoptions.forEach(function(req) { %>
                                    <tr class="border-t border-t-[#e4e0dd]">
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#171412] text-sm font-normal leading-normal">
                                            <div class="flex items-center gap-2">
                                                <% if (req.pet_image) { %>
                                                    <img src="<%= req.pet_image %>" alt="Pet Image"
                                                        class="h-10 w-10 object-cover rounded" />
                                                    <% } %>
                                                        <span>
                                                            <%= req.pet_name %>
                                                        </span>
                                            </div>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#171412] text-sm font-normal leading-normal">
                                            <%= req.full_name %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <div>
                                                <%= req.email %>
                                            </div>
                                            <div>
                                                <%= req.phone_number %>
                                            </div>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <%= req.request_date ? new Date(req.request_date).toISOString().slice(0,10)
                                                : '—' %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <%= req.client_reason ? req.client_reason : '—' %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <% if (req.status==='Pending' ) { %>
                                                <form action="/adoption/approve" method="POST" class="mb-2">
                                                    <input type="hidden" name="adoption_id"
                                                        value="<%= req.adoption_id %>">
                                                    <textarea name="shelter_response" placeholder="Response to client"
                                                        required class="border rounded p-1 w-full mb-1"></textarea>
                                                    <input type="date" name="visit_date"
                                                        class="border rounded p-1 mb-1 w-full" required>
                                                    <button type="submit"
                                                        class="bg-green-600 text-white px-2 py-1 rounded text-xs">Approve</button>
                                                </form>
                                                <form action="/adoption/reject" method="POST">
                                                    <input type="hidden" name="adoption_id"
                                                        value="<%= req.adoption_id %>">
                                                    <textarea name="shelter_response" placeholder="Reason for rejection"
                                                        required class="border rounded p-1 w-full mb-1"></textarea>
                                                    <button type="submit"
                                                        class="bg-red-600 text-white px-2 py-1 rounded text-xs">Reject</button>
                                                </form>
                                                <% } else if (req.status==='Approved' ) { %>
                                                    <form action="/adoption/finalize" method="POST"
                                                        style="display:inline;">
                                                        <input type="hidden" name="adoption_id"
                                                            value="<%= req.adoption_id %>">
                                                        <input type="hidden" name="pet_id" value="<%= req.pet_id %>">
                                                        <input type="hidden" name="visit_date"
                                                            value="<%= req.visit_date ? req.visit_date.toISOString ? req.visit_date.toISOString().slice(0,10) : req.visit_date : '' %>">
                                                        <button name="final_status" value="Adopted" type="submit"
                                                            class="bg-blue-600 text-white px-2 py-1 rounded text-xs mr-1"
                                                            onclick="return confirm('Mark this pet as Adopted? This will finalize the adoption.');">
                                                            Mark as Adopted
                                                        </button>
                                                        <button name="final_status" value="Available" type="submit"
                                                            class="bg-green-600 text-white px-2 py-1 rounded text-xs"
                                                            onclick="return confirm('Mark this pet as Available? This will cancel the adoption and make the pet available again.');">
                                                            Mark as Available
                                                        </button>
                                                    </form>
                                                    <% } else { %>
                                                        <%= req.shelter_response ? req.shelter_response : '—' %>
                                                            <% } %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <%= req.visit_date ? (req.visit_date.toISOString ?
                                                req.visit_date.toISOString().slice(0,10) : req.visit_date) : '—' %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <%= req.status %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                        </td>
                                    </tr>
                                    <% }); %>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- My Pets Table -->
                <h2 id="my-pets"
                    class="text-[#171412] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">My
                    Pets</h2>
                <div class="px-4 py-3">
                    <div class="flex overflow-hidden rounded-xl border border-[#e4e0dd] bg-white">
                        <table class="flex-1 w-full">
                            <thead>
                                <tr class="bg-white">
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Image</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Name</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Type</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Breed</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Age</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Gender</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Status</th>
                                    <th class="px-4 py-3 text-left text-[#171412] text-sm font-medium leading-normal">
                                        Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% pets.forEach(function(pet) { %>
                                    <tr class="border-t border-t-[#e4e0dd]">
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#171412] text-sm font-normal leading-normal">
                                            <% if (pet.pet_image) { %>
                                                <img src="<%= pet.pet_image %>" alt="Pet Image"
                                                    class="h-12 w-12 object-cover rounded" />
                                                <% } else { %>
                                                    —
                                                    <% } %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#171412] text-sm font-normal leading-normal">
                                            <%= pet.name %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <%= pet.species %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <%= pet.breed %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <%= pet.age %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <%= pet.gender %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <%= pet.status %>
                                        </td>
                                        <td
                                            class="h-[72px] px-4 py-2 text-[#837567] text-sm font-normal leading-normal">
                                            <% if (pet.status !=='Adopted' ) { %>
                                                <form action="/pet/mark-adopted" method="POST" class="inline">
                                                    <input type="hidden" name="pet_id" value="<%= pet.pet_id %>">
                                                    <button type="submit"
                                                        class="bg-blue-600 text-white px-2 py-1 rounded text-xs">Mark
                                                        Adopted</button>
                                                </form>
                                                <% } %>
                                                    <form action="/pet/delete" method="POST" class="inline"
                                                        onsubmit="return confirm('Delete this pet?');">
                                                        <input type="hidden" name="pet_id" value="<%= pet.pet_id %>">
                                                        <button type="submit"
                                                            class="bg-red-600 text-white px-2 py-1 rounded text-xs">Delete</button>
                                                    </form>
                                        </td>
                                    </tr>
                                    <% }); %>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Add New Pet -->
                <h2 id="add-pet"
                    class="text-[#171412] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">Add
                    New Pet</h2>
                <form action="/pet/add" method="POST">
                    <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
                        <label class="flex flex-col min-w-40 flex-1">
                            <p class="text-[#171412] text-base font-medium leading-normal pb-2">Pet Name</p>
                            <input name="name" placeholder="Enter pet name" required
                                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#171412] border border-[#e4e0dd] bg-white h-14 placeholder:text-[#837567] p-[15px] text-base font-normal leading-normal" />
                        </label>
                    </div>
                    <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
                        <label class="flex flex-col min-w-40 flex-1">
                            <p class="text-[#171412] text-base font-medium leading-normal pb-2">Pet Type</p>
                            <select name="species" required
                                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#171412] border border-[#e4e0dd] bg-white h-14 p-[15px] text-base font-normal leading-normal">
                                <option value="">Select type</option>
                                <option value="Dog">Dog</option>
                                <option value="Cat">Cat</option>
                                <option value="Bird">Bird</option>
                                <option value="Rabbit">Rabbit</option>
                                <option value="Reptile">Reptile</option>
                                <option value="Fish">Fish</option>
                                <option value="Other">Other</option>
                            </select>
                        </label>
                    </div>
                    <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
                        <label class="flex flex-col min-w-40 flex-1">
                            <p class="text-[#171412] text-base font-medium leading-normal pb-2">Breed</p>
                            <input name="breed" placeholder="Enter breed" required
                                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#171412] border border-[#e4e0dd] bg-white h-14 placeholder:text-[#837567] p-[15px] text-base font-normal leading-normal" />
                        </label>
                    </div>
                    <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
                        <label class="flex flex-col min-w-40 flex-1">
                            <p class="text-[#171412] text-base font-medium leading-normal pb-2">Age</p>
                            <input name="age" type="number" placeholder="Enter age" required min="0"
                                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#171412] border border-[#e4e0dd] bg-white h-14 placeholder:text-[#837567] p-[15px] text-base font-normal leading-normal" />
                        </label>
                    </div>
                    <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
                        <label class="flex flex-col min-w-40 flex-1">
                            <p class="text-[#171412] text-base font-medium leading-normal pb-2">Gender</p>
                            <select name="gender" required
                                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#171412] border border-[#e4e0dd] bg-white h-14 p-[15px] text-base font-normal leading-normal">
                                <option value="">Select gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select>
                        </label>
                    </div>
                    <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
                        <label class="flex flex-col min-w-40 flex-1">
                            <p class="text-[#171412] text-base font-medium leading-normal pb-2">Pet Image URL</p>
                            <input type="text" name="pet_image" placeholder="Paste image URL"
                                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#171412] border border-[#e4e0dd] bg-white h-14 p-[15px] text-base font-normal leading-normal" />
                        </label>
                    </div>
                    <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
                        <label class="flex flex-col min-w-40 flex-1">
                            <p class="text-[#171412] text-base font-medium leading-normal pb-2">Description</p>
                            <textarea name="description" placeholder="Enter description"
                                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#171412] border border-[#e4e0dd] bg-white min-h-36 placeholder:text-[#837567] p-[15px] text-base font-normal leading-normal"></textarea>
                        </label>
                    </div>
                    <div class="flex px-4 py-3 justify-end">
                        <button
                            class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#d18c47] text-[#171412] text-sm font-bold leading-normal tracking-[0.015em]"
                            type="submit">
                            <span class="truncate">Add Pet</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>

</html>